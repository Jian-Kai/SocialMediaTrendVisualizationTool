<html>

<head>
    <!-- libs -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js'></script>
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
    <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js'></script>

    <script src="http://ajax.googleapis.com/ajax/libs/prototype/1.7/prototype.js"></script>
    <script src="http://calendarview.org/releases/1.2/javascripts/calendarview.js"></script>
    <link href="http://calendarview.org/releases/1.2/stylesheets/calendarview.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
        body {
            font-family: Trebuchet MS;
        }

        div.calendar {
            max-width: 240px;
            margin-left: auto;
            margin-right: auto;
        }

        div.calendar table {
            width: 100%;
            margin-top: 150px;
        }
    </style>
</head>

<body>
    <div id="fb-root"></div>
    <script src='../server/fbOauthLogin.js'></script>
    <div class='container'>
        <div class='col-lg-12 text-center'>
            <h2>First, you need to login Facebook: </h2>
            <button class="btn btn-link btn-inverse offset3" id="user-info" class="muted"></button>
            <button type="button" class="btn btn-inverse" id="fb-auth"></button>
            <h2>Enter the Facebook http URL or postid, or choose a post from example posts</h2>
            <input class='input-medium' id='postid_input' placeholder='Facebook URL / Facebook Post Id'></input>
            <input class="input-small" id="sinceDateField" type="text" placeholder="yyyy-mm-dd">
            <input class="input-small" id="untilDateField" type="text" placeholder="yyyy-mm-dd">
            <br>
            <button class='btn btn-primary' id='submit_btn' onclick="retrievePostid('first')">Visualize data!</button>
            <button class='btn btn-primary' id='DB_btn' onclick="retrievePostid('sec')">Visualize DB data!</button>
        </div>
    </div>

    <script>
        function setupCalendars() {
            // Popup Calendar
            Calendar.setup({
                dateField: 'sinceDateField',
                triggerElement: 'sinceDateField'
            })
            Calendar.setup({
                dateField: 'untilDateField',
                triggerElement: 'untilDateField'
            })
        }
        Event.observe(window, 'load', function() {
            setupCalendars()
        });



        function retrievePostid(value) {
            function reqListener() {
                var raw_data = JSON.parse(this.responseText);
                console.log(raw_data);
                console.log(raw_data.data.length);
                data = raw_data;
            }
            var postid = document.getElementById("postid_input").value;
            var since = document.getElementById("sinceDateField").value.split("-");
            var until = document.getElementById("untilDateField").value.split("-");
            var oReq = new XMLHttpRequest();
            oReq.onload = reqListener;
            if (value == "first") {
                var qurl = "text" + "?action=first&postid=" + postid + "&token=" + ACCESS_TOKEN;
            } else {
                var qurl = "text" + "?action=sec";
            }
            console.log(qurl);
            oReq.open("get", qurl, true);
            oReq.send();
        }
    </script>

</body>

</html>
